**Лекция 2**

### Критерий, базирующийся на знаках разниц

u1, u2, ..., uN - временной ряд

H0 - ряд случаен
H1 - ряд имеет тренд

xi = 1, u_i < u_(i+1)
xi = 0.5, u_i = u_(i+1)
xi = 0, u_i > u_(i+1)

C = ∑xi, i=1..N-1

M{C} = (N-1)/2
D{C} = (N+1)/12

u = (C - M{C}) / sqrt(D{C})

|u| <= u_(alpha/2) => H0 - принимается.
Если u > u_(alpha/2) => тренд на возрастание
Если u < -u_(alpha/2) => тренд на убывание

### Критерий рекордных значений

Рекордное значение - значение, которые либо больше всех предыдущих, либо меньше всех предыдущих.

H0 - ряд случаен
H1 - ряд имеет тренд

li = 1, ui < u1 & ui < u2 & ... & ui < u_(i-1)
li = 0, otherwise

mi = 1, ui > u1 & ui > u2 & ... & ui > u_(i-1)
mi = 0, otherwise

L = ∑li, i = 1..N-1
M = ∑mi, i = 1..N-1

D = M - L
S = M + L
(критерии Фостера-Стюарта)

Обе величины сходятся к нормальному распределению, но с раздными параметрами.

M{D} = 0
D{D} = ∑2/i, i = 2..N = rho

M{S} = D{D}
D{S} = ∑(2/i - 4/i^2), i = 2..N = rho

Статистика для D
H0 - ряд случаен
H1 - присутствует тенденция изменения среднего

T1 = (D - M{D}) / sqrt(D{D})
|T1| <= u_(alpha/2)

Статистика для S
H0 - дисперсия константа
H1 - дисперсия изменяется

T2 = (S - M{S}) / sqrt(D{S})
|T2| <= u_(alpha/2)

## Ранговые критерии

### Критерий Спирмена

H0 - ряд случаен
H1 - ряд имеет тренд

hij = 1, ui < uj
hij = 0.5, ui = uj
hij = 0, ui > uj

V = ∑∑ hij(j-i), i = 1..N-1, j = i+1..N

r_с = 1 - 12V / N(N^2-1)

H0 = r_c = 0
H1 = r_c ≠ 0

M{r_c} = 0
D{r_c} = 1/(N-1)
S = r_c / sqrt(D{rc})

|S| <= u_(alpha/2) - H0 принимается

### Критерий Манна

Tn = ∑∑ hij, i = 1..N-1, j = i+1..N

M{Tn} = N(N-1)/2
D{Tn} = N(N-1)(2N+5)/12

u = (Tn-M{Tn}+0.5) / sqrt(D{Tn})

|u| <= u_(alpha/2)


## Кореллограмма

### Критерий сериальной корелляции

u1, u2, ..., uN - временной ряд

Сериальной корелляции rk с запаздыванием (лагом) k называет корелляцию между элементами временного ряда, расположенными на растоянии k друг от друга.

r1 = corr(u1, u2, ..., u_(N-1); u2, u3, ..., uN)
r2 = corr(u1, u2, ..., u_(N-2); u3, u4, ..., uN)
...

r0, ..., rk - кореллограмма

rk  = ... (слишком большая формула)

Также известна как **автокорреляционная функция**



